<!DOCTYPE html>
<html>
<head>
    <title>å•†å“ç®¡ç†å¾Œå°</title>
    <meta charset="utf-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding: 20px; }
        .form-group { margin-bottom: 15px; }
        .product-img { max-width: 60px; max-height: 60px; object-fit: cover; margin-right: 10px; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="container">
        <h2>æ–°å¢é¦–é å•†å“</h2>
        <form id="productForm">
            <div class="form-group">
                <label for="productZhTitle">å•†å“åç¨±ï¼ˆä¸­æ–‡ï¼‰</label>
                <input type="text" class="form-control" id="productZhTitle" required>
            </div>
            <div class="form-group">
                <label for="productEnTitle">å•†å“åç¨±ï¼ˆè‹±æ–‡ï¼‰</label>
                <input type="text" class="form-control" id="productEnTitle" required>
            </div>
            <div class="form-group">
                <label for="productZhPrice">åƒ¹æ ¼ï¼ˆä¸­æ–‡ï¼‰</label>
                <input type="text" class="form-control" id="productZhPrice" value="åƒ¹æ ¼ï¼šè¯çµ¡æˆ‘å€‘ç²å¾—å ±åƒ¹" required>
            </div>
            <div class="form-group">
                <label for="productEnPrice">åƒ¹æ ¼ï¼ˆè‹±æ–‡ï¼‰</label>
                <input type="text" class="form-control" id="productEnPrice" value="Price: Contact us for a quote" required>
            </div>
            <div class="form-group">
                <label for="productZhDesc">å•†å“ä»‹ç´¹ï¼ˆä¸­æ–‡ï¼‰</label>
                <textarea class="form-control" id="productZhDesc" rows="3" required></textarea>
            </div>
            <div class="form-group">
                <label for="productEnDesc">å•†å“ä»‹ç´¹ï¼ˆè‹±æ–‡ï¼‰</label>
                <textarea class="form-control" id="productEnDesc" rows="3" required></textarea>
            </div>
            <div class="form-group">
                <label for="productImages">å•†å“åœ–ç‰‡ URLï¼ˆå¤šå¼µåœ–ç‰‡ä»¥é€—è™Ÿ `,` åˆ†éš”ï¼‰</label>
                <input type="text" class="form-control" id="productImages" placeholder="ä¾‹å¦‚: /images/web-cw1.jpg,/images/web-cw2.jpg" required>
            </div>
            <div class="form-group">
                <label for="productLink">å•†å“é é¢é€£çµ</label>
                <input type="text" class="form-control" id="productLink" placeholder="ä¾‹å¦‚: wood_commodity/first.html" required>
            </div>
            <button type="submit" class="btn btn-primary" id="addProductBtn">æ–°å¢å•†å“</button>
        </form>

        <hr>

        <h3>å·²æ–°å¢å•†å“åˆ—è¡¨</h3>
        <ul id="productList" class="list-group"></ul>
    </div>

<script>
    const form = document.getElementById('productForm');
    const productList = document.getElementById('productList');
    let editIndex = null; // ç´€éŒ„ç·¨è¼¯ä¸­çš„å•†å“ç´¢å¼•

    function renderProductList() {
        const products = JSON.parse(localStorage.getItem('front')) || [];
        productList.innerHTML = '';
        if (products.length === 0) {
            productList.innerHTML = '<li class="list-group-item text-muted">ç›®å‰æ²’æœ‰ä»»ä½•ä½œå“ã€‚</li>';
        } else {
            products.forEach((product, index) => {
                const firstImage = product.images && product.images.length > 0 ? product.images[0] : '';
                const li = document.createElement('li');
                li.className = 'list-group-item d-flex justify-content-between align-items-start';
                li.innerHTML = `
                    <div class="d-flex align-items-start">
                        ${firstImage ? `<img src="${firstImage}" alt="å•†å“åœ–ç‰‡" class="product-img">` : ''}
                        <div>
                            <a href="${product.link}" target="_blank" class="fw-semibold">
                                ${index + 1}. ${product.zhTitle} <span class="badge bg-secondary">#${product.id}</span>
                            </a>
                            <div class="text-muted small text-truncate" style="max-width: 60ch;">
                                ${product.zhDesc ? product.zhDesc : ''}
                            </div>
                            <div class="small text-danger">
                                ${product.zhPrice ? product.zhPrice : ''}
                            </div>
                        </div>
                    </div>
                    <div>
                        <button class="btn btn-warning btn-sm edit-btn" data-index="${index}">ç·¨è¼¯</button>
                        <button class="btn btn-danger btn-sm delete-btn" data-index="${index}">åˆªé™¤</button>
                    </div>
                `;
                productList.appendChild(li);
            });
        }
    }

    form.addEventListener('submit', (e) => {
        e.preventDefault();

        const productZhTitle = document.getElementById('productZhTitle').value;
        const productEnTitle = document.getElementById('productEnTitle').value;
        const productZhPrice = document.getElementById('productZhPrice').value;
        const productEnPrice = document.getElementById('productEnPrice').value;
        const productZhDesc = document.getElementById('productZhDesc').value;
        const productEnDesc = document.getElementById('productEnDesc').value;
        const productImages = document.getElementById('productImages').value.split(',').map(url => url.trim());
        const productLink = document.getElementById('productLink').value;

        const newProduct = {
            id: Date.now(), // ğŸ”¥ è‡ªå‹•ç”¢ç”Ÿå”¯ä¸€å•†å“ ID
            zhTitle: productZhTitle,
            enTitle: productEnTitle,
            zhPrice: productZhPrice,
            enPrice: productEnPrice,
            zhDesc: productZhDesc,
            enDesc: productEnDesc,
            images: productImages,
            link: productLink
        };

        const products = JSON.parse(localStorage.getItem('front')) || [];

        if (editIndex !== null) {
            // ä¿ç•™åŸæœ¬çš„ idï¼Œé¿å…ç·¨è¼¯æ™‚æ›æ‰
            newProduct.id = products[editIndex].id;
            products[editIndex] = newProduct; 
            alert('ä½œå“å·²æˆåŠŸä¿®æ”¹ï¼');
            editIndex = null;
            document.getElementById('addProductBtn').textContent = 'æ–°å¢å•†å“';
        } else {
            products.push(newProduct); 
            alert('ä½œå“å·²æˆåŠŸæ–°å¢ï¼');
        }

        localStorage.setItem('front', JSON.stringify(products));
        form.reset();
        renderProductList();
    });

    productList.addEventListener('click', (e) => {
        const products = JSON.parse(localStorage.getItem('front')) || [];

        if (e.target.classList.contains('delete-btn')) {
            const index = e.target.dataset.index;
            products.splice(index, 1);
            localStorage.setItem('front', JSON.stringify(products));
            alert('ä½œå“å·²æˆåŠŸåˆªé™¤ï¼');
            renderProductList();
        }

        if (e.target.classList.contains('edit-btn')) {
            editIndex = e.target.dataset.index;
            const product = products[editIndex];

            document.getElementById('productZhTitle').value = product.zhTitle;
            document.getElementById('productEnTitle').value = product.enTitle;
            document.getElementById('productZhPrice').value = product.zhPrice;
            document.getElementById('productEnPrice').value = product.enPrice;
            document.getElementById('productZhDesc').value = product.zhDesc;
            document.getElementById('productEnDesc').value = product.enDesc;
            document.getElementById('productImages').value = product.images.join(', ');
            document.getElementById('productLink').value = product.link;

            document.getElementById('addProductBtn').textContent = 'æ›´æ–°å•†å“';
        }
    });

    renderProductList();
</script>

</body>
</html>
